{
  "version": "0.1",
  "name": "HJS-AIP Audit Mapping",
  "description": "Mapping from AIP v1alpha3 audit log fields to HJS v1.0 primitives",
  "last_updated": "2026-02-27",
  
  "mappings": [
    {
      "hjs_primitive": "delegation",
      "description": "Records the chain of responsibility from requester to agent",
      "source": "AAT Validation Event",
      "aip_fields": {
        "from": "user_id",
        "to": "agent_id",
        "time": "timestamp",
        "scope": "delegation_scope",
        "constraints": "capabilities (from AAT)"
      },
      "generation_rule": "Generate when AAT is validated by proxy",
      "aip_section_ref": "Section 7.3.3 (User Binding Claims)"
    },
    {
      "hjs_primitive": "judgment",
      "description": "Records the basis on which the AI agent made its decision",
      "source": "tools/call Request",
      "aip_fields": {
        "input_commitment": "SHA256(args)",
        "model_id": "model_id (proposed extension)",
        "parameters": "model_parameters (proposed extension)"
      },
      "generation_rule": "Generate when tools/call is processed; requires AIP to log model context",
      "aip_section_ref": "Section 12 (Audit Log Format) + proposed extensions",
      "notes": "Model_id and parameters are not currently in AIP audit log; proposed for v1alpha4"
    },
    {
      "hjs_primitive": "termination",
      "description": "Records the final outcome of the task",
      "source": "tools/call Response",
      "aip_fields": {
        "status": "decision (ALLOW/BLOCK)",
        "output_commitment": "SHA256(response) (proposed extension)",
        "duration_ms": "calculated from request/response timestamps"
      },
      "generation_rule": "Generate when tools/call completes",
      "aip_section_ref": "Section 12 (Audit Log Format)"
    },
    {
      "hjs_primitive": "verification",
      "description": "Records how the result was verified",
      "source": "AAT Validation + Registry Check",
      "aip_fields": {
        "verifier": "aat_issuer",
        "method": "signature_verification",
        "time": "timestamp",
        "result": "valid/invalid"
      },
      "generation_rule": "Derived from AAT validation result",
      "aip_section_ref": "Section 7.5.3 (AAT Validation)"
    }
  ],
  
  "evidence_chain": {
    "description": "Building the HJS evidence package from AIP logs",
    "steps": [
      "1. Extract each primitive from AIP audit events",
      "2. Hash each primitive: h1 = SHA256(delegation), h2 = SHA256(judgment), h3 = SHA256(termination), h4 = SHA256(verification)",
      "3. Compute chain_hash = SHA256(h1 + h2 + h3 + h4)",
      "4. Optionally generate OpenTimestamps proof for chain_hash",
      "5. Store chain_hash in audit log as evidence reference"
    ],
    "example_chain_hash": "sha256: a3c7f2e8d9b4f1e2c8a7d6f3e9b2c4f1a8e7d3c2b5f4e9a7c3d8f2b6e1a9c4f7"
  },
  
  "aip_extensions_needed": [
    {
      "field": "model_id",
      "location": "audit_log",
      "rationale": "Required for HJS Judgment primitive to record which AI model made the decision",
      "proposed_for": "v1alpha4"
    },
    {
      "field": "model_parameters",
      "location": "audit_log", 
      "rationale": "Required for HJS Judgment primitive to record model configuration (temperature, max_tokens, etc.)",
      "proposed_for": "v1alpha4"
    },
    {
      "field": "output_commitment",
      "location": "audit_log",
      "rationale": "Required for HJS Termination primitive to record what was returned (as SHA256 commitment)",
      "proposed_for": "v1alpha4"
    }
  ]
}
